{% extends "base.html" %}

{% load static %}

{% block title %} Drug Interactions {% endblock %}
{% block head %}
  <link rel="stylesheet" href="{% static 'css/drug_interaction.css' %}" />
{% endblock %}
{% block content %}
    <article>
        <header>
          <div>
            <p>Discover</p>
            <h1>Drug Interactions</h1>
            <p>
              Enter the effective ingredients of your medications to check for
              potential interactions.
            </p>
          </div>
        </header>
        <div class="middle">
          <section>
            <form id="addDrugForm" class="form" method="get" autocomplete="off">
              <div class="form-cont position-relative">
                <h6>Drug(s)</h6>
                <div id="autocompletes"></div>
                <input class="drug-name" type="text" value="{{ drug }}" placeholder="Enter Drug Name">
                <a class="add-drug">Add</a>
                <div class="drugs"></div>
              </div>
              <div class="buttons">
                <button class="mb-3" type="submit">Analyze</button>
                <br />
                <a class="btn-clear">Clear</a>
              </div>
            </form>
          </section>

          <section>
            <h6 class="text-center">Guides</h6>
            <ul>
                <li>
                  <svg width="35" height="35" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M17.0923 22.8577C17.3253 22.6248 17.6747 22.6248 17.9077 22.8577L29.7005 34.6506C30.1664 35.1165 30.8943 35.1165 31.3602 34.6506L34.6506 31.3602C34.8253 31.1855 34.9418 30.9817 34.9709 30.7488C35.0582 30.3702 34.9418 29.9626 34.6506 29.7005L22.8577 17.9368C22.6248 17.7038 22.6248 17.3253 22.8577 17.1215L34.6506 5.32862C35.1165 4.86273 35.1165 4.13478 34.6506 3.66889L31.3602 0.349418C31.1855 0.174709 30.9817 0.0582363 30.7488 0.0291182C30.3702 -0.0582362 29.9626 0.0582363 29.7005 0.349418L17.9077 12.1423C17.6747 12.3752 17.2962 12.3752 17.0923 12.1423L5.2995 0.349418C4.83361 -0.116473 4.10566 -0.116473 3.63977 0.349418L0.349418 3.63977C0.174709 3.81448 0.0582363 4.0183 0.0291182 4.25125C-0.0582362 4.62978 0.0582363 5.03744 0.349418 5.2995L12.1423 17.0923C12.3752 17.3253 12.3752 17.7038 12.1423 17.9077L0.349418 29.7005C-0.116473 30.1664 -0.116473 30.8943 0.349418 31.3602L3.63977 34.6506C3.81448 34.8253 4.0183 34.9418 4.25125 34.9709C4.62978 35.0582 5.03744 34.9418 5.2995 34.6506L17.0923 22.8577Z" fill="url(#paint0_linear_938_2967)"/>
                      <defs>
                      <linearGradient id="paint0_linear_938_2967" x1="17.5" y1="0.156108" x2="17.5" y2="47.4608" gradientUnits="userSpaceOnUse">
                      <stop stop-color="#FF5252"/>
                      <stop offset="0.2061" stop-color="#FD4D4D"/>
                      <stop offset="0.4365" stop-color="#F64040"/>
                      <stop offset="0.6787" stop-color="#EA2A2A"/>
                      <stop offset="0.9274" stop-color="#DA0B0B"/>
                      <stop offset="1" stop-color="#D50000"/>
                      </linearGradient>
                      </defs>
                  </svg>
                  Severity Level: Major
                </li>
                <li>
                  <svg width="35" height="35" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.5 35C27.165 35 35 27.165 35 17.5C35 7.83502 27.165 0 17.5 0C7.83502 0 0 7.83502 0 17.5C0 27.165 7.83502 35 17.5 35Z" fill="url(#paint0_linear_938_2972)"/>
                    <g opacity="0.2">
                    <path d="M17.5 0.875C26.6671 0.875 34.125 8.33292 34.125 17.5C34.125 26.6671 26.6671 34.125 17.5 34.125C8.33292 34.125 0.875 26.6671 0.875 17.5C0.875 8.33292 8.33292 0.875 17.5 0.875ZM17.5 0C7.83417 0 0 7.83417 0 17.5C0 27.1658 7.83417 35 17.5 35C27.1658 35 35 27.1658 35 17.5C35 7.83417 27.1658 0 17.5 0Z" fill="#424242"/>
                    </g>
                    <g opacity="0.2">
                    <path d="M29.166 15.1667C29.8106 15.1667 30.3327 15.6888 30.3327 16.3334V18.6667C30.3327 19.3113 29.8106 19.8334 29.166 19.8334H5.83268C5.1881 19.8334 4.66602 19.3113 4.66602 18.6667V16.3334C4.66602 15.6888 5.1881 15.1667 5.83268 15.1667H29.166ZM29.166 14.2917H5.83268C4.70685 14.2917 3.79102 15.2076 3.79102 16.3334V18.6667C3.79102 19.7926 4.70685 20.7084 5.83268 20.7084H29.166C30.2919 20.7084 31.2077 19.7926 31.2077 18.6667V16.3334C31.2077 15.2076 30.2919 14.2917 29.166 14.2917Z" fill="#424242"/>
                    </g>
                    <path d="M29.167 19.8334H5.83366C5.18908 19.8334 4.66699 19.3113 4.66699 18.6667V16.3334C4.66699 15.6888 5.18908 15.1667 5.83366 15.1667H29.167C29.8116 15.1667 30.3337 15.6888 30.3337 16.3334V18.6667C30.3337 19.3113 29.8116 19.8334 29.167 19.8334Z" fill="#FAFAFA"/>
                    <defs>
                    <linearGradient id="paint0_linear_938_2972" x1="17.5" y1="4.27787" x2="17.5" y2="35.2508" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#FF5252"/>
                    <stop offset="0.324" stop-color="#F33B3B"/>
                    <stop offset="1" stop-color="#D50000"/>
                    </linearGradient>
                    </defs>
                  </svg>
                  Severity Level: Moderate
                </li>
                <li>
                  <svg width="7" height="35" viewBox="0 0 7 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.50001 35C5.43301 35 7.00002 33.433 7.00002 31.5C7.00002 29.567 5.43301 28 3.50001 28C1.56701 28 0 29.567 0 31.5C0 33.433 1.56701 35 3.50001 35Z" fill="url(#paint0_linear_938_2982)"/>
                    <path d="M5.29114 25.6667H1.70947C1.07071 25.6667 0.548629 25.1592 0.534046 24.5263L0.000293452 1.19292C-0.0142899 0.539585 0.516545 0 1.17571 0H5.82489C6.48406 0 7.0149 0.539585 7.00031 1.19292L6.46656 24.5263C6.45198 25.1592 5.92989 25.6667 5.29114 25.6667Z" fill="url(#paint1_linear_938_2982)"/>
                    <g opacity="0.2">
                    <path d="M3.50001 28.875C4.94668 28.875 6.12502 30.0533 6.12502 31.5C6.12502 32.9467 4.94668 34.125 3.50001 34.125C2.05334 34.125 0.875003 32.9467 0.875003 31.5C0.875003 30.0533 2.05334 28.875 3.50001 28.875ZM3.50001 28C1.56625 28 0 29.5663 0 31.5C0 33.4338 1.56625 35 3.50001 35C5.43377 35 7.00002 33.4338 7.00002 31.5C7.00002 29.5663 5.43377 28 3.50001 28Z" fill="#424242"/>
                    <path d="M5.82489 0.875003C5.93864 0.875003 6.00864 0.933336 6.04364 0.965419C6.08156 1.00625 6.12823 1.07334 6.12531 1.1725L5.59156 24.5059C5.58864 24.6634 5.45156 24.7917 5.29114 24.7917H1.70947C1.54613 24.7917 1.41196 24.6634 1.40905 24.5059L0.875296 1.1725C0.872379 1.07334 0.919046 1.00625 0.956962 0.965419C0.991963 0.933336 1.06196 0.875003 1.17571 0.875003H5.82489ZM5.82489 0H1.17571C0.516545 0 -0.0142899 0.539585 0.000293452 1.19292L0.534046 24.5263C0.548629 25.1592 1.07071 25.6667 1.70947 25.6667H5.28822C5.92698 25.6667 6.44906 25.1592 6.46365 24.5263L6.9974 1.19292C7.0149 0.539585 6.48406 0 5.82489 0Z" fill="#424242"/>
                    </g>
                    <defs>
                    <linearGradient id="paint0_linear_938_2982" x1="3.50001" y1="0.1144" x2="3.50001" y2="34.8046" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#FF5252"/>
                    <stop offset="0.2061" stop-color="#FD4D4D"/>
                    <stop offset="0.4365" stop-color="#F64040"/>
                    <stop offset="0.6787" stop-color="#EA2A2A"/>
                    <stop offset="0.9274" stop-color="#DA0B0B"/>
                    <stop offset="1" stop-color="#D50000"/>
                    </linearGradient>
                    <linearGradient id="paint1_linear_938_2982" x1="3.5003" y1="0.11448" x2="3.5003" y2="34.8047" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#FF5252"/>
                    <stop offset="0.2061" stop-color="#FD4D4D"/>
                    <stop offset="0.4365" stop-color="#F64040"/>
                    <stop offset="0.6787" stop-color="#EA2A2A"/>
                    <stop offset="0.9274" stop-color="#DA0B0B"/>
                    <stop offset="1" stop-color="#D50000"/>
                    </linearGradient>
                    </defs>
                  </svg>
                  Severity Level: Minor
                </li>
            </ul>
          </section>
        </div>
        <div class="result p-3 p-md-5" id="result_container">
          {% if errors %}
            <div id="result_container">
                {% for error in errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
          {% elif interactions is not None %}
  
          <h3 class="mb-4 text-center" id="result_container">
          </h3>
          <div class="interaction-result">
             {% for interaction in interactions %}
                      <h3>{{ interaction.drug1 }} â‡„ {{ interaction.drug2 }}:</h3>
                      <p>{{ interaction.reason }}</p>
              {% empty %}
                  <p>No interactions found</p>
              {% endfor %}
          </div> 
      {% endif %}

        </div>
      </article>
      <button class="toggle-nav d-md-none d-none"><i class="fa-solid fa-arrow-right"></i></button>


      <!-- Modal -->
      <div
        class="modal fade"
        id="myModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">Error</h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">...</div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
    </article>


    

    
{% endblock content %}

{% block script %}
<script>
  let all_drugs = {{ all_drugs| safe }};
  let words = [{% for drug in all_drugs %}"{{drug}}", {% endfor %}];
</script>
<script src="{% static 'js/autocomplete.js' %}"></script>
<script src="{% static 'js/drug_interaction.js' %}"></script>
{% endblock %}
